# UTXO Model

电路中使用 UTXO 模式验证交易是否是正确的。具体来说电路中支持了 6 输入和 6 输出的 UTXO 结构。
其中 2 个输入是隐私的，两个是公开的。2 个输出的隐私的，2 个输出是公开的。

## Build And Check UTXO

### Verify Private Input

针对每一个隐私输入，具体的验证逻辑如下：

1. 使用 Opened 计算 Commitment。
2. 检查 FreezeFlag 必须为 0
3. 检查 Merkle Proof
4. 检查 OwnerSignature 是否为空
   1. 为空，则检查 SpentAddress 也为空会失败。
   1. 不为空，则将被签名数据中的 SpentAddress 覆盖 OpenedOutput 中的 SpentAddress。
5. 使用 SpentSecKey 计算一个 SpentAddress，检查和 OpenedOutput 中的是否一致，不一致则说明私钥不正确
6. 使用 SpentSecKey 和 Commitment 计算 Nullifier

### Verify Private Output

针对每一个隐私输出，需要执行这样的验证逻辑和工作：

1. 计算 Commitment。
2. 使用 ViewPubKey 生成加密的 OwnerMemo。
3. 使用 AuditPubKey 生成加密的 AuditMemo。

### Verify By Asset

所有输入和输出都要依据于资产类型进行检查：

1. 要保证所有资产类型得左右金额相等。
2. 要保证资产输入和输出的 AuditPubKey 保持不变。
